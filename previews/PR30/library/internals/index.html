<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Private · OceanTurbulenceParameterEstimation.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://adelinehillier.github.io/OceanTurbulenceParameterEstimation/dev/library/internals/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OceanTurbulenceParameterEstimation.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation Instructions</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../outline/">Contents</a></li><li><a class="tocitem" href="../public/">Public</a></li><li class="is-active"><a class="tocitem" href>Private</a><ul class="internal"><li><a class="tocitem" href="#OceanTurbulenceParameterEstimation"><span>OceanTurbulenceParameterEstimation</span></a></li><li><a class="tocitem" href="#Observations"><span>Observations</span></a></li><li><a class="tocitem" href="#TurbulenceClosureParameters"><span>TurbulenceClosureParameters</span></a></li><li><a class="tocitem" href="#EnsembleKalmanInversions"><span>EnsembleKalmanInversions</span></a></li></ul></li><li><a class="tocitem" href="../function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Private</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Private</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/master/docs/src/library/internals.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Private-types-and-functions"><a class="docs-heading-anchor" href="#Private-types-and-functions">Private types and functions</a><a id="Private-types-and-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Private-types-and-functions" title="Permalink"></a></h1><p>Documentation for <code>OceanTurbulenceParameterEstimation.jl</code>&#39;s internal interface.</p><h2 id="OceanTurbulenceParameterEstimation"><a class="docs-heading-anchor" href="#OceanTurbulenceParameterEstimation">OceanTurbulenceParameterEstimation</a><a id="OceanTurbulenceParameterEstimation-1"></a><a class="docs-heading-anchor-permalink" href="#OceanTurbulenceParameterEstimation" title="Permalink"></a></h2><h2 id="Observations"><a class="docs-heading-anchor" href="#Observations">Observations</a><a id="Observations-1"></a><a class="docs-heading-anchor-permalink" href="#Observations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.Observations.FieldTimeSeriesCollector-Tuple{Any, Any}" href="#OceanTurbulenceParameterEstimation.Observations.FieldTimeSeriesCollector-Tuple{Any, Any}"><code>OceanTurbulenceParameterEstimation.Observations.FieldTimeSeriesCollector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FieldTimeSeriesCollector(fields)</code></pre><p>Returns a <code>FieldTimeSeriesCollector</code> for <code>fields</code> of <code>simulation</code>.</p><p><code>fields</code> is a <code>NamedTuple</code> of <code>AbstractField</code>s that are to be collected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/Observations.jl#L108-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.Observations.OneDimensionalTimeSeries" href="#OceanTurbulenceParameterEstimation.Observations.OneDimensionalTimeSeries"><code>OceanTurbulenceParameterEstimation.Observations.OneDimensionalTimeSeries</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OneDimensionalTimeSeries{F, G, T, P, M} &lt;: AbstractObservation</code></pre><p>A time series of horizontally-averaged observational or LES data gridded as Oceananigans fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/Observations.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.Observations.column_ensemble_interior-Tuple{Vector{var&quot;#s12&quot;} where var&quot;#s12&quot;&lt;:OneDimensionalTimeSeries, Any, Vector{T} where T, Any}" href="#OceanTurbulenceParameterEstimation.Observations.column_ensemble_interior-Tuple{Vector{var&quot;#s12&quot;} where var&quot;#s12&quot;&lt;:OneDimensionalTimeSeries, Any, Vector{T} where T, Any}"><code>OceanTurbulenceParameterEstimation.Observations.column_ensemble_interior</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">column_ensemble_interior(observations::Vector{&lt;:OneDimensionalTimeSeries}, field_name, time_indices::Vector, N_ens)</code></pre><p>Returns an <code>N_cases × N_ens</code> array of the interior of a field <code>field_name</code> defined on a  <code>OneDimensionalEnsembleGrid</code> of size <code>N_cases × N_ens × Nz</code>, given a list of <code>OneDimensionalTimeSeries</code> objects containing the <code>N_cases</code> single-column fields at the corresponding time index in <code>time_indices</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/Observations.jl#L88-L94">source</a></section></article><h2 id="TurbulenceClosureParameters"><a class="docs-heading-anchor" href="#TurbulenceClosureParameters">TurbulenceClosureParameters</a><a id="TurbulenceClosureParameters-1"></a><a class="docs-heading-anchor-permalink" href="#TurbulenceClosureParameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.TurbulenceClosureParameters.FreeParameters-Tuple{Any}" href="#OceanTurbulenceParameterEstimation.TurbulenceClosureParameters.FreeParameters-Tuple{Any}"><code>OceanTurbulenceParameterEstimation.TurbulenceClosureParameters.FreeParameters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FreeParameters(priors; names = Symbol.(keys(priors)))</code></pre><p>Return named <code>FreeParameters</code> with priors. Free parameter <code>names</code> are inferred from the keys of <code>priors</code> if not provided.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; priors = (ν = Normal(1e-4, 1e-5), κ = Normal(1e-3, 1e-5))

julia&gt; free_parameters = FreeParameter(priors)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/TurbulenceClosureParameters.jl#L15-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.TurbulenceClosureParameters.closure_with_parameters-Union{Tuple{TD}, Tuple{Oceananigans.TurbulenceClosures.AbstractTurbulenceClosure{TD}, Any}} where TD" href="#OceanTurbulenceParameterEstimation.TurbulenceClosureParameters.closure_with_parameters-Union{Tuple{TD}, Tuple{Oceananigans.TurbulenceClosures.AbstractTurbulenceClosure{TD}, Any}} where TD"><code>OceanTurbulenceParameterEstimation.TurbulenceClosureParameters.closure_with_parameters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">closure_with_parameters(closure, parameters)</code></pre><p>Returns a new object where for each (<code>parameter_name</code>, <code>parameter_value</code>) pair  in <code>parameters</code>, the value corresponding to the key in <code>object</code> that matches <code>parameter_name</code> is replaced with <code>parameter_value</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; struct ClosureSubModel a; b end

julia&gt; struct Closure test; c end

julia&gt; closure = Closure(ClosureSubModel(1, 2), 3)
Closure(ClosureSubModel(1, 2), 3)

julia&gt; parameters = (a = 12, c = 7)
(a = 12, c = 7)

julia&gt; closure_with_parameters(closure, parameters)
Closure(ClosureSubModel(12, 2), 7)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/TurbulenceClosureParameters.jl#L84-L108">source</a></section></article><h2 id="EnsembleKalmanInversions"><a class="docs-heading-anchor" href="#EnsembleKalmanInversions">EnsembleKalmanInversions</a><a id="EnsembleKalmanInversions-1"></a><a class="docs-heading-anchor-permalink" href="#EnsembleKalmanInversions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.EnsembleKalmanInversion-Tuple{Any}" href="#OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.EnsembleKalmanInversion-Tuple{Any}"><code>OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.EnsembleKalmanInversion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">EnsembleKalmanInversion(inverse_problem; noise_covariance=1e-2)</code></pre><p>Return an object that interfaces with EnsembleKalmanProcesses.jl to iteratively &quot;solve&quot; the inverse problem</p><p class="math-container">\[y = G(θ) + η,\]</p><p>for the parameters <span>$θ$</span>, where <span>$y$</span> is a &quot;normalized&quot; vector of observations, <span>$G(θ)$</span> is a forward map that predicts the observations, and <span>$η ∼ N(0, Γy)$</span> is zero-mean random noise with covariance matrix <span>$Γy$</span> representing uncertainty in the observations.</p><p>By &quot;solve&quot;, we mean that the iteration finds  <span>$θ$</span> that minimizes the distance between <span>$y$</span> and <span>$G(θ)$</span>.</p><p>The &quot;forward map output&quot; <code>G</code> can have many interpretations. The specific statistics that <code>G</code> computes have to be selected for each use  case to provide a concise summary of the complex model solution that contains the values that  we would most like to match to the corresponding truth values <code>y</code>. In the OSBL context, this summary  could be, for example, a vector of concatenated <code>u</code>, <code>v</code>, <code>b</code>, <code>e</code> profiles at all or some time steps  of the CATKE solution.</p><p><strong>Arguments</strong></p><ul><li><p><code>inverse_problem::InverseProblem</code>: Represents an inverse problem representing the comparison between                                    synthetic observations generated by Oceananigans and model                                    predictions also generated by Oceananigans.</p></li><li><p><code>noise_covariance</code> (<code>AbstractMatrix</code> or <code>Number</code>): normalized covariance representing observational                                                    uncertainty. If <code>noise_covariance isa Number</code> then                                                    it&#39;s converted to an identity matrix scaled by                                                    <code>noise_covariance</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/EnsembleKalmanInversions.jl#L75-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.UnscentedKalmanInversion-Tuple{Any, Any, Any}" href="#OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.UnscentedKalmanInversion-Tuple{Any, Any, Any}"><code>OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.UnscentedKalmanInversion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">UnscentedKalmanInversion(inverse_problem, prior_mean, prior_cov; noise_covariance=1e-2, α_reg = 1.0, update_freq = 0)</code></pre><p><strong>Arguments</strong></p><ul><li><code>inverse_problem</code>         : inverse problem</li><li><code>prior_mean::Array{Float64}</code>   : prior mean</li><li><code>prior_cov::Array{Float64, 2}</code> : prior covariance</li><li><code>noise_covariance::Float64</code>    : observation error covariance</li><li><code>α_reg::Float64</code>               : regularization parameter toward <code>u0</code> (0 &lt; <code>α_reg</code> ≤ 1), default should be 1, without regulariazion</li><li><code>update_freq::IT</code> : set to 0 when the inverse problem is not identifiable (default),                  namely the inverse problem has multiple solutions,                  the covariance matrix will represent only the sensitivity of the parameters,                  instead of posterior covariance information;                 set to 1 (or anything &gt; 0) when the inverse problem is identifiable, and                  the covariance matrix will converge to a good approximation of the                  posterior covariance with an uninformative prior.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/EnsembleKalmanInversions.jl#L137-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.iterate!-Tuple{EnsembleKalmanInversion}" href="#OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.iterate!-Tuple{EnsembleKalmanInversion}"><code>OceanTurbulenceParameterEstimation.EnsembleKalmanInversions.iterate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">iterate!(eki::EnsembleKalmanInversion; iterations=1)</code></pre><p>Iterate the ensemble Kalman inversion problem <code>eki</code> forward by <code>iterations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adelinehillier/OceanTurbulenceParameterEstimation.jl/blob/2761de58ebf952521b6b868d6abcd67476b1a0f8/src/EnsembleKalmanInversions.jl#L233-L237">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">« Public</a><a class="docs-footer-nextpage" href="../function_index/">Function index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 28 October 2021 05:27">Thursday 28 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
